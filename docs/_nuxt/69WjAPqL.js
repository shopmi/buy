import{r as x,u as b,e as h,c as l,o as d,f,a as r,g as w,h as s,t as u,d as v,_ as k,b as _}from"./CTKMNkxH.js";import{u as M}from"./BBAxtCiP.js";const C={class:"w-full max-w-md mx-auto p-6 bg-white rounded-xl shadow-lg border border-gray-100"},S={class:"bg-gray-50 p-4 rounded-lg mb-6 text-sm border border-gray-200"},q={class:"flex justify-between items-center pt-2 border-t border-gray-200"},I={class:"flex items-center space-x-2"},P={class:"font-bold text-indigo-600 text-lg"},j={class:"mt-2 text-right text-xs text-gray-400"},R={key:0,class:"mb-4 p-3 bg-red-50 text-red-600 text-sm rounded-lg text-center"},U=["disabled"],B={key:0,class:"flex items-center"},N={key:1},V={__name:"LibStripe",props:{priceId:{type:String,default:""},initialAmount:{type:Number,default:99}},emits:["init"],setup(p,{emit:g}){const i=b(),m=p,y=g,e=x({id:"lib-stripe-checkout-"+Math.round(Math.random()*9999),stripe:null,loading:!0,quantity:m.initialAmount,errorMessage:"",async init(){await(t=>new Promise(n=>{const a=()=>{t.every(c=>!!window[c])?n(!0):requestAnimationFrame(a)};a()}))(["Stripe"]),i.public.stripeKey?e.stripe=Stripe(i.public.stripeKey):e.errorMessage="Stripe Key não configurada.",e.loading=!1,y("init",e)},async checkout(){if(!e.stripe)return;e.loading=!0;const o=m.priceId||i.public.stripePriceId;if(!o){e.errorMessage="Price ID não configurado.",e.loading=!1;return}try{const t=new URL(window.location.href),n=new URL(t);n.searchParams.set("status","success");const a=new URL(t);a.searchParams.set("status","cancel"),console.log("Iniciando Checkout:",{price:o,quantity:parseInt(e.quantity)});const{error:c}=await e.stripe.redirectToCheckout({lineItems:[{price:o,quantity:parseInt(e.quantity)}],mode:"payment",successUrl:n.toString(),cancelUrl:a.toString()});c&&(console.error("Stripe Error:",c),e.errorMessage=c.message,e.loading=!1)}catch(t){console.error("System Error:",t),e.errorMessage=t.message||"Erro desconhecido ao redirecionar.",e.loading=!1}}});return h(()=>{e.init()}),M({script:[{key:"stripe",src:"https://js.stripe.com/v3/"}]}),(o,t)=>(d(),l("div",C,[t[6]||(t[6]=f('<div class="text-center mb-6"><div class="inline-flex items-center justify-center w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></div><h3 class="text-xl font-bold text-gray-800">Checkout Dinâmico</h3><p class="text-gray-500 text-sm">Sem Backend • PIX e Cartão</p></div>',1)),r("div",S,[t[4]||(t[4]=f('<div class="flex justify-between items-center mb-2"><span class="text-gray-600">Produto (Fixo):</span><span class="font-medium text-gray-900">Camiseta Premium</span></div><div class="flex justify-between items-center mb-2"><span class="text-gray-600">Preço Base:</span><span class="font-mono text-gray-600">R$ 1,00 (unidade)</span></div>',2)),r("div",q,[t[3]||(t[3]=r("span",{class:"text-gray-800 font-bold"},"Total (Qtd):",-1)),r("div",I,[r("button",{onClick:t[0]||(t[0]=n=>s(e).quantity>1?s(e).quantity--:null),class:"w-6 h-6 rounded bg-gray-200 hover:bg-gray-300 flex items-center justify-center"}," - "),r("span",P,u(s(e).quantity),1),r("button",{onClick:t[1]||(t[1]=n=>s(e).quantity++),class:"w-6 h-6 rounded bg-gray-200 hover:bg-gray-300 flex items-center justify-center"}," + ")])]),r("div",j," Total a pagar: R$ "+u(s(e).quantity)+",00 ",1)]),s(e).errorMessage?(d(),l("div",R,u(s(e).errorMessage),1)):w("",!0),r("button",{onClick:t[2]||(t[2]=(...n)=>s(e).checkout&&s(e).checkout(...n)),disabled:s(e).loading||!s(e).stripe,class:"w-full bg-indigo-600 text-white font-bold py-4 px-6 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-200 transition-all duration-200 flex items-center justify-center"},[s(e).loading?(d(),l("span",B,[...t[5]||(t[5]=[r("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),v(" Inicializando... ",-1)])])):(d(),l("span",N," Pagar R$ "+u(s(e).quantity)+",00 com Stripe ",1))],8,U)]))}},$={};function z(p,g){const i=V;return d(),l("div",null,[_(i)])}const E=k($,[["render",z]]);export{E as default};

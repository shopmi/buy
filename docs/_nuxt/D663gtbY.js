import{M as w,N as y,O as x,c as l,o as c,e as m,Q as b,f as k,a as s,u as r,t as d,d as v}from"./CbQZwg3K.js";import{u as M}from"./DWj1k5-R.js";const q={key:0,class:"w-full max-w-md mx-auto p-4 rounded-xl text-center border border-white/10 bg-white/5"},C={class:"bg-black/20 p-4 rounded-lg mb-6 text-sm border border-white/5"},S={class:"flex justify-between items-center pt-2 border-t border-white/10"},I={class:"flex items-center space-x-2"},_={class:"font-bold text-white text-lg"},P={class:"mt-2 text-right text-xs text-gray-500"},j={key:0,class:"mb-4 p-3 bg-red-900/20 text-red-400 text-sm rounded-lg text-center border border-red-500/30"},R=["disabled"],U={key:0,class:"flex items-center"},B={key:1},z={__name:"LibStripe",props:{priceId:{type:String,default:""},initialAmount:{type:Number,default:99}},emits:["init"],setup(g,{emit:f}){const u=y(),p=g,h=f,e=w({id:"lib-stripe-checkout-"+Math.round(Math.random()*9999),stripe:null,loading:!0,quantity:p.initialAmount,errorMessage:"",async init(){await(t=>new Promise(i=>{const n=()=>{t.every(a=>!!window[a])?i(!0):requestAnimationFrame(n)};n()}))(["Stripe"]),u.public.stripeKey?e.stripe=Stripe(u.public.stripeKey):e.errorMessage="Stripe Key não configurada.",e.loading=!1,h("init",e)},async checkout(){if(!e.stripe)return;e.loading=!0;const o=p.priceId||u.public.stripePriceId;if(!o){e.errorMessage="Price ID não configurado.",e.loading=!1;return}try{const t=new URL(window.location.href),i=new URL(t);i.searchParams.set("order_status","success");const n=new URL(t);n.searchParams.set("order_status","cancel"),console.log("Iniciando Checkout:",{price:o,quantity:parseInt(e.quantity)});const{error:a}=await e.stripe.redirectToCheckout({lineItems:[{price:o,quantity:parseInt(e.quantity)}],mode:"payment",successUrl:i.toString(),cancelUrl:n.toString()});a&&(console.error("Stripe Error:",a),e.errorMessage=a.message,e.loading=!1)}catch(t){console.error("System Error:",t),e.errorMessage=t.message||"Erro desconhecido ao redirecionar.",e.loading=!1}}});return x(()=>{e.init()}),M({script:[{key:"stripe",src:"https://js.stripe.com/v3/"}]}),(o,t)=>(c(),l("div",null,[o.$slots.default?m("",!0):(c(),l("div",q,[t[7]||(t[7]=k('<div class="mb-6"><div class="inline-flex items-center justify-center w-16 h-16 bg-white/10 text-white rounded-full mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></div><h3 class="text-xl font-bold text-white">Checkout Dinâmico</h3><p class="text-gray-400 text-sm">Sem Backend • PIX e Cartão</p></div>',1)),s("div",C,[t[4]||(t[4]=s("div",{class:"flex justify-between items-center mb-2 text-gray-300"},[s("span",null,"Produto (Fixo):"),s("span",{class:"font-medium text-white"},"Camiseta Premium")],-1)),t[5]||(t[5]=s("div",{class:"flex justify-between items-center mb-2 text-gray-300"},[s("span",null,"Preço Base:"),s("span",{class:"font-mono text-white"},"R$ 1,00 (unidade)")],-1)),s("div",S,[t[3]||(t[3]=s("span",{class:"font-bold text-gray-300"},"Total (Qtd):",-1)),s("div",I,[s("button",{onClick:t[0]||(t[0]=i=>r(e).quantity>1?r(e).quantity--:null),class:"w-6 h-6 rounded bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition-colors"}," - "),s("span",_,d(r(e).quantity),1),s("button",{onClick:t[1]||(t[1]=i=>r(e).quantity++),class:"w-6 h-6 rounded bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition-colors"}," + ")])]),s("div",P," Total a pagar: R$ "+d(r(e).quantity)+",00 ",1)]),r(e).errorMessage?(c(),l("div",j,d(r(e).errorMessage),1)):m("",!0),s("button",{onClick:t[2]||(t[2]=(...i)=>r(e).checkout&&r(e).checkout(...i)),disabled:r(e).loading||!r(e).stripe,class:"w-full bg-white text-black font-bold py-4 px-6 rounded-lg hover:bg-gray-200 focus:outline-none transition-all duration-200 flex items-center justify-center"},[r(e).loading?(c(),l("span",U,[...t[6]||(t[6]=[s("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-black",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),v(" Inicializando... ",-1)])])):(c(),l("span",B," Pagar R$ "+d(r(e).quantity)+",00 com Stripe ",1))],8,R)])),b(o.$slots,"default",{checkout:r(e).checkout,loading:r(e).loading,quantity:r(e).quantity,errorMessage:r(e).errorMessage})]))}};export{z as _};
